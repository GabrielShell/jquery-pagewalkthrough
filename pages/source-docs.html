<!DOCTYPE html><html lang="en"><head><title>src/jquery.pagewalkthrough</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="src/jquery.pagewalkthrough"><meta name="groc-project-path" content="src/jquery.pagewalkthrough.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/jquery.pagewalkthrough.js</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="cm">/***</span>
<span class="cm"> * Author: Erwin Yusrizal</span>
<span class="cm"> * UX by: Tai Nguyen</span>
<span class="cm"> * Contributors: James West &lt;jwwest@gmail.com&gt;</span>
<span class="cm"> *               JP Adams &lt;jpadamsonline@gmail.com&gt;</span>
<span class="cm"> *               James Warwood &lt;james.duncan.1991@googlemail.com&gt;</span>
<span class="cm"> *               Craig Roberts &lt;craig0990@googlemail.com&gt;</span>
<span class="cm"> * Created On: 27/02/2013</span>
<span class="cm"> * Version: 2.1.0</span>
<span class="cm"> * Issue, Feature &amp; Bug Support: https://github.com/warby-/jquery-pagewalkthrough/issues</span>
<span class="cm"> ***/</span>

<span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>GLOBAL VAR</p></div></div><div class="code"><div class="wrapper">  <span class="kd">var</span> <span class="nx">_globalWalkthrough</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="nx">_elements</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="nx">_activeWalkthrough</span><span class="p">,</span>
    <span class="nx">_activeId</span><span class="p">,</span>
    <span class="nx">_hasDefault</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">_counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">_isCookieLoad</span><span class="p">,</span>
    <span class="nx">_firstTimeLoad</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">_onLoad</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// Counter for default walkthrough IDs</span>
    <span class="nx">_isWalkthroughActive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">$jpwOverlay</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;jpwOverlay&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">),</span>
    <span class="nx">$jpWalkthrough</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;jpWalkthrough&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">),</span>
    <span class="nx">$jpwTooltip</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;jpwTooltip&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">);</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>PUBLIC METHOD</p></div></div><div class="code"><div class="wrapper">  <span class="kd">var</span> <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">isActive</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="o">!!</span><span class="nx">_isWalkthroughActive</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">currIndex</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">_index</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">//init method</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">pagewalkthrough</span><span class="p">.</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Must provide a unique name for a tour&#39;</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

        <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">elementID</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

        <span class="nx">_globalWalkthrough</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
        <span class="nx">_elements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

        <span class="c1">//check if onLoad and this is first time load</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">onLoad</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_counter</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">//get first onload = true</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">_counter</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">_onLoad</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_activeId</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
          <span class="nx">_activeWalkthrough</span> <span class="o">=</span> <span class="nx">_globalWalkthrough</span><span class="p">[</span><span class="nx">_activeId</span><span class="p">];</span>
          <span class="nx">_onLoad</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>set the activeWalkthrough if onLoad is false for all walkthroughs</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="p">((</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">===</span> <span class="nx">that</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">_counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">_activeId</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
          <span class="nx">_activeWalkthrough</span> <span class="o">=</span> <span class="nx">_globalWalkthrough</span><span class="p">[</span><span class="nx">_elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
          <span class="nx">_hasDefault</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>when user scroll the page, scroll it back to keep walkthrough on user view</p></div></div><div class="code"><div class="wrapper">        <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scroll</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">_isWalkthroughActive</span> <span class="o">&amp;&amp;</span> <span class="nx">_activeWalkthrough</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">lockScrolling</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;scrollTimer&#39;</span><span class="p">));</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;scrollTimer&#39;</span><span class="p">,</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
              <span class="nx">scrollToTarget</span><span class="p">(</span><span class="nx">_activeWalkthrough</span><span class="p">);</span>
            <span class="p">},</span> <span class="mi">250</span><span class="p">));</span>
          <span class="p">}</span>

          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
      <span class="p">});</span>
    <span class="p">},</span>

    <span class="nx">renderOverlay</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

      <span class="c1">//if each walkthrough has onLoad = true, throw warning message to the console</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">_counter</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39;Warning: Only first walkthrough will be shown onLoad as default&#39;</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="c1">//get cookie load</span>
      <span class="nx">_isCookieLoad</span> <span class="o">=</span> <span class="nx">getCookie</span><span class="p">(</span><span class="s1">&#39;_walkthrough-&#39;</span> <span class="o">+</span> <span class="nx">_activeId</span><span class="p">);</span>

      <span class="c1">//check if first time walkthrough</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">_isCookieLoad</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_isWalkthroughActive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">buildWalkthrough</span><span class="p">();</span>
        <span class="nx">showButton</span><span class="p">(</span><span class="s1">&#39;jpwClose&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">);</span>

        <span class="nx">scrollToTarget</span><span class="p">();</span>

        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="c1">//call onAfterShow callback</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">isFirstStep</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">_firstTimeLoad</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onAfterShow</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">//check when user used to close the walkthrough to call the onCookieLoad callback</span>
        <span class="nx">onCookieLoad</span><span class="p">(</span><span class="nx">_globalWalkthrough</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">restart</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isFirstStep</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

      <span class="nx">_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">onRestart</span><span class="p">(</span><span class="nx">e</span><span class="p">)))</span> <span class="k">return</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">onEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">)))</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">buildWalkthrough</span><span class="p">();</span>

      <span class="nx">scrollToTarget</span><span class="p">();</span>

    <span class="p">},</span>

    <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">_firstTimeLoad</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

      <span class="nx">_isWalkthroughActive</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//set cookie to false</span>
        <span class="nx">setCookie</span><span class="p">(</span><span class="s1">&#39;_walkthrough-&#39;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">365</span><span class="p">);</span>
        <span class="nx">_isCookieLoad</span> <span class="o">=</span> <span class="nx">getCookie</span><span class="p">(</span><span class="s1">&#39;_walkthrough-&#39;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//set cookie to false</span>
        <span class="nx">setCookie</span><span class="p">(</span><span class="s1">&#39;_walkthrough-&#39;</span> <span class="o">+</span> <span class="nx">_activeId</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">365</span><span class="p">);</span>
        <span class="nx">_isCookieLoad</span> <span class="o">=</span> <span class="nx">getCookie</span><span class="p">(</span><span class="s1">&#39;_walkthrough-&#39;</span> <span class="o">+</span> <span class="nx">_activeId</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="nx">$jpwOverlay</span><span class="p">.</span><span class="nx">fadeOut</span><span class="p">(</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">});</span>

      <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">fadeOut</span><span class="p">(</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">});</span>

      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwClose&#39;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">(</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">});</span>

    <span class="p">},</span>

    <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_isWalkthroughActive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">_firstTimeLoad</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> FIXME which walkthrough to show - the below is a hotfix to get the plugin
actually working</span></p></div></div><div class="code"><div class="wrapper">      <span class="nx">_activeId</span> <span class="o">=</span> <span class="nx">target</span> <span class="o">||</span> <span class="nx">_activeId</span><span class="p">;</span>
      <span class="nx">_activeWalkthrough</span> <span class="o">=</span> <span class="nx">_globalWalkthrough</span><span class="p">[</span><span class="nx">_activeId</span><span class="p">];</span>

      <span class="nx">buildWalkthrough</span><span class="p">();</span>
      <span class="nx">showButton</span><span class="p">(</span><span class="s1">&#39;jpwClose&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">);</span>

      <span class="nx">scrollToTarget</span><span class="p">();</span>

      <span class="c1">//call onAfterShow callback</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isFirstStep</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">_firstTimeLoad</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onAfterShow</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

    <span class="p">},</span>

    <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_firstTimeLoad</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isLastStep</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onLeave</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">_index</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">buildWalkthrough</span><span class="p">();</span>

      <span class="nx">scrollToTarget</span><span class="p">();</span>

    <span class="p">},</span>

    <span class="nx">prev</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isFirstStep</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onLeave</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">_index</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">_index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">buildWalkthrough</span><span class="p">();</span>

      <span class="nx">scrollToTarget</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="nx">getOptions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">activeWalkthrough</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">_wtObj</span><span class="p">;</span>

      <span class="c1">//get only current active walkthrough</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">activeWalkthrough</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_wtObj</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">_wtObj</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>
        <span class="c1">//get all walkthrough</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">_wtObj</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">wt</span> <span class="k">in</span> <span class="nx">_globalWalkthrough</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_wtObj</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">_globalWalkthrough</span><span class="p">[</span><span class="nx">wt</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">_wtObj</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span> <span class="c1">//end public method</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>BUILD OVERLAY</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">buildWalkthrough</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="c1">//call onBeforeShow callback</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isFirstStep</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">_firstTimeLoad</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">onBeforeShow</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Extend step options with defaults</p></div></div><div class="code"><div class="wrapper">    <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span>
        <span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">pagewalkthrough</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">]</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;modal&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;nohighlight&#39;</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

      <span class="c1">//check if wrapper is not empty or undefined</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Your walkthrough position is: &quot;&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;&quot; but wrapper is empty or undefined. Please check your &quot;&#39;</span> <span class="o">+</span> <span class="nx">_activeId</span> <span class="o">+</span> <span class="s1">&#39;&quot; wrapper parameter.&#39;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">topOffset</span> <span class="o">=</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">leftOffset</span> <span class="o">=</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">transparentWidth</span> <span class="o">=</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">innerWidth</span><span class="p">())</span> <span class="o">||</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">width</span><span class="p">());</span>
      <span class="kd">var</span> <span class="nx">transparentHeight</span> <span class="o">=</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">innerHeight</span><span class="p">())</span> <span class="o">||</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">height</span><span class="p">());</span>

      <span class="c1">//get all margin and make it gorgeous with the &#39;px&#39;, if it has no px, IE will get angry !!</span>
      <span class="kd">var</span> <span class="nx">marginTop</span> <span class="o">=</span> <span class="nx">cssSyntax</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">margin</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">),</span>
        <span class="nx">marginRight</span> <span class="o">=</span> <span class="nx">cssSyntax</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">margin</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">),</span>
        <span class="nx">marginBottom</span> <span class="o">=</span> <span class="nx">cssSyntax</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">margin</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">),</span>
        <span class="nx">marginLeft</span> <span class="o">=</span> <span class="nx">cssSyntax</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">margin</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">),</span>
        <span class="nx">roundedCorner</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="nx">overlayClass</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="nx">killOverlay</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">overlayTopStyle</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">topOffset</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span><span class="p">)))</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">overlayLeftStyle</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">leftOffset</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nx">roundedCorner</span><span class="p">)),</span>
        <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">))</span>
      <span class="p">}</span>


      <span class="c1">//check if use overlay</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">overlayClass</span> <span class="o">=</span> <span class="s1">&#39;overlay&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">overlayClass</span> <span class="o">=</span> <span class="s1">&#39;noOverlay&#39;</span><span class="p">;</span>
        <span class="nx">killOverlay</span> <span class="o">=</span> <span class="s1">&#39;killOverlay&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">overlayTop</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;overlayTop&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">overlayClass</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">overlayTopStyle</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">overlayLeft</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;overlayLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">overlayClass</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">overlayLeftStyle</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">accessible</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">highlightedAreaStyle</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
          <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
          <span class="s1">&#39;topCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">))</span>
          <span class="p">},</span>
          <span class="s1">&#39;middleLeft&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">))</span>
          <span class="p">},</span>
          <span class="s1">&#39;middleCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">)),</span>
            <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">))</span>
          <span class="p">},</span>
          <span class="s1">&#39;middleRight&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">))</span>
          <span class="p">},</span>
          <span class="s1">&#39;bottomCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">))</span>
          <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">highlightedArea</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;highlightedArea&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">highlightedAreaStyle</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

        <span class="nx">highlightedArea</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topCenter&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">topCenter</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

        <span class="s1">&#39;&lt;div style=&quot;clear: left;&quot;&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;middleLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;height:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">middleLeft</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;middleCenter&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">middleCenter</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;;height:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">middleCenter</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&amp;nbsp;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;middleRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;height:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">middleRight</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

        <span class="s1">&#39;&lt;div style=&quot;clear: left;&quot;&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomCenter&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">bottomCenter</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="c1">//if accessible</span>
        <span class="kd">var</span> <span class="nx">highlightedAreaStyle</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
          <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
          <span class="s1">&#39;topCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">))</span>
          <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">accessibleStyle</span> <span class="o">=</span> <span class="p">{</span>

          <span class="s1">&#39;topAccessible&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;position&#39;</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
            <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
            <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
            <span class="s1">&#39;topCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">))</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s1">&#39;middleAccessible&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;position&#39;</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
            <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">+</span> <span class="nx">roundedCorner</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
            <span class="s1">&#39;middleLeft&#39;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">))</span>
            <span class="p">},</span>
            <span class="s1">&#39;middleRight&#39;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">)),</span>
              <span class="s1">&#39;right&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nx">roundedCorner</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">))</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s1">&#39;bottomAccessible&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
            <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">+</span> <span class="nx">roundedCorner</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginTop</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginBottom</span><span class="p">)),</span>
            <span class="s1">&#39;bottomCenter&#39;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">transparentWidth</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginLeft</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">marginRight</span><span class="p">))</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">highlightedArea</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;topAccessible&quot; style=&quot;position:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">topAccessible</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="s1">&#39;; top:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">topAccessible</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s1">&#39;;left:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">topAccessible</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topCenter&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">topAccessible</span><span class="p">.</span><span class="nx">topCenter</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;topRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

        <span class="s1">&#39;&lt;div id=&quot;middleAccessible&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;clear: left;position:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="s1">&#39;; top:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s1">&#39;;left:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;middleLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;height:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">middleLeft</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;middleRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;position:absolute;right:-&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">middleRight</span><span class="p">.</span><span class="nx">right</span> <span class="o">+</span> <span class="s1">&#39;;height:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">middleAccessible</span><span class="p">.</span><span class="nx">middleRight</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

        <span class="s1">&#39;&lt;div id=&quot;bottomAccessible&quot; style=&quot;clear: left;position:absolute;left:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">bottomAccessible</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;;top:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">bottomAccessible</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomLeft&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomCenter&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">bottomAccessible</span><span class="p">.</span><span class="nx">bottomCenter</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;div id=&quot;bottomRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">killOverlay</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

      <span class="p">}</span> <span class="c1">//end checking accessible</span>

      <span class="kd">var</span> <span class="nx">highlightedAreaWidth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">accessible</span><span class="p">)</span> <span class="o">?</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">accessibleStyle</span><span class="p">.</span><span class="nx">topAccessible</span><span class="p">.</span><span class="nx">topCenter</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">highlightedAreaStyle</span><span class="p">.</span><span class="nx">topCenter</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">));</span>


      <span class="kd">var</span> <span class="nx">overlayRightStyle</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="nx">highlightedAreaWidth</span><span class="p">),</span>
        <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
        <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">windowWidth</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="nx">highlightedAreaWidth</span><span class="p">))</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">overlayRight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;overlayRight&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">overlayClass</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">overlayRightStyle</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

      <span class="kd">var</span> <span class="nx">overlayBottomStyle</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;height&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">))),</span>
        <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayTopStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">overlayLeftStyle</span><span class="p">.</span><span class="nx">height</span><span class="p">))</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">overlayBottom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;overlayBottom&quot; class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">overlayClass</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">overlayBottomStyle</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>



      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">accessible</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">showTooltip</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">showTooltip</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span>


    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;modal&#39;</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">showModal</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">showModal</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpWalkthrough&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>


      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">overlay</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">noHighlight</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">noHighlight</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">showButton</span><span class="p">(</span><span class="s1">&#39;jpwPrevious&#39;</span><span class="p">);</span>
    <span class="nx">showButton</span><span class="p">(</span><span class="s1">&#39;jpwNext&#39;</span><span class="p">);</span>
    <span class="nx">showButton</span><span class="p">(</span><span class="s1">&#39;jpwFinish&#39;</span><span class="p">);</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>SHOW MODAL</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">showModal</span><span class="p">(</span><span class="nx">isOverlay</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">,</span>
      <span class="nx">overlayClass</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">content</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isOverlay</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$jpwOverlay</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">textRotation</span> <span class="o">=</span> <span class="nx">setRotation</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span><span class="p">));</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;position&#39;</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
      <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="s1">&#39;50%&#39;</span><span class="p">,</span>
      <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="s1">&#39;20%&#39;</span><span class="p">,</span>
      <span class="s1">&#39;margin-left&#39;</span><span class="o">:</span> <span class="o">-</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">,</span>
      <span class="s1">&#39;z-index&#39;</span><span class="o">:</span> <span class="s1">&#39;9999&#39;</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">tooltipSlide</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipTop&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipInner&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipBottom&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">);</span>

    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">tooltipSlide</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">wrapInner</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipWrapper&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;bottom-scratch&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tooltipWrapper&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">textRotation</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tooltipInner&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">getContent</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">])).</span><span class="nx">show</span><span class="p">();</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;margin-top&#39;</span><span class="p">,</span> <span class="o">-</span><span class="p">((</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>SHOW TOOLTIP</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">showTooltip</span><span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">opt</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">tooltipWidth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">300</span> <span class="o">:</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
      <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">arrowTop</span><span class="p">,</span> <span class="nx">arrowLeft</span><span class="p">,</span>
      <span class="nx">roundedCorner</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
      <span class="nx">overlayHoleWidth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#topAccessible&#39;</span><span class="p">).</span><span class="nx">innerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#topAccessible&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">innerWidth</span><span class="p">()</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">(),</span>
      <span class="nx">overlayHoleHeight</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#middleAccessible&#39;</span><span class="p">).</span><span class="nx">innerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#middleAccessible&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">roundedCorner</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">innerHeight</span><span class="p">()</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">(),</span>
      <span class="nx">overlayHoleTop</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#topAccessible&#39;</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span><span class="p">,</span>
      <span class="nx">overlayHoleLeft</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#topAccessible&#39;</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#highlightedArea&#39;</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">,</span>
      <span class="nx">arrow</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
      <span class="nx">draggable</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">textRotation</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="nx">clearRotation</span><span class="p">()</span> <span class="o">:</span> <span class="nx">setRotation</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span><span class="p">));</span>


    <span class="c1">//delete jwOverlay if any</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">tooltipSlide</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipTop&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipInner&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipBottom&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">);</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;margin-left&#39;</span><span class="o">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
      <span class="s1">&#39;margin-top&#39;</span><span class="o">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
      <span class="s1">&#39;position&#39;</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
      <span class="s1">&#39;z-index&#39;</span><span class="o">:</span> <span class="s1">&#39;9999&#39;</span>
    <span class="p">})</span>
      <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">tooltipSlide</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">wrapInner</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipWrapper&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">draggable</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;drag-area&quot; class=&quot;draggable-area&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tooltipWrapper&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">textRotation</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tooltipInner&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">getContent</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">])).</span><span class="nx">show</span><span class="p">();</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;span class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&amp;nbsp;&lt;/span&gt;&#39;</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">case</span> <span class="s1">&#39;top&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">overlayHoleTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">)</span> <span class="o">-</span> <span class="mi">86</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">overlayHoleLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">overlayHoleWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">40</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">overlayHoleLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">overlayHoleWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">overlayHoleTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">);</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="nx">overlayHoleLeft</span> <span class="o">+</span> <span class="nx">overlayHoleWidth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">)</span> <span class="o">+</span> <span class="mi">105</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;bottom&#39;</span><span class="o">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">isAccessible</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nx">overlayHoleTop</span> <span class="o">+</span> <span class="nx">overlayHoleHeight</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">)</span> <span class="o">+</span> <span class="mi">86</span><span class="p">;</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">overlayHoleLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">overlayHoleWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">40</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">top</span> <span class="o">=</span> <span class="nx">overlayHoleTop</span> <span class="o">+</span> <span class="nx">overlayHoleHeight</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">)</span> <span class="o">+</span> <span class="mi">86</span><span class="p">;</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">overlayHoleLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">overlayHoleWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">overlayHoleTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">);</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="nx">overlayHoleLeft</span> <span class="o">-</span> <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">)</span> <span class="o">-</span> <span class="mi">105</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwTooltip span.&#39;</span> <span class="o">+</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">arrowLeft</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">top</span><span class="p">),</span>
      <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">left</span><span class="p">)</span>
    <span class="p">});</span>
    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Get the content for a step.  First attempts to treat step.popup.content
as a selector.  If this fails, or returns an empty result set, it falls
back to return the value of step.popup.content.</p>

<p>This allows both selectors and literal content to be provided in the
content option.</p>

<p>Parameters:</p>

<ul>
<li><strong>step must be an Object.</strong><br/>(The step data to return the content for)</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">getContent</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="nx">step</span><span class="p">.</span><span class="nx">popup</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span>
      <span class="nx">content</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">content</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">option</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">content</span> <span class="o">||</span> <span class="nx">option</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>POPUP NO HIGHLIGHT</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">noHighlight</span><span class="p">(</span><span class="nx">isOverlay</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">opt</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">,</span>
      <span class="nx">overlayClass</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">wrapperTop</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span><span class="p">,</span>
      <span class="nx">wrapperLeft</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">,</span>
      <span class="nx">wrapperWidth</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">width</span><span class="p">(),</span>
      <span class="nx">wrapperHeight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">height</span><span class="p">(),</span>
      <span class="nx">arrow</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
      <span class="nx">draggable</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">arrowTop</span><span class="p">,</span> <span class="nx">arrowLeft</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isOverlay</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$jpwOverlay</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwOverlay&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">clearRotation</span><span class="p">());</span>

    <span class="kd">var</span> <span class="nx">textRotation</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nx">setRotation</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">contentRotation</span><span class="p">));</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;position&#39;</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
      <span class="s1">&#39;margin-left&#39;</span><span class="o">:</span> <span class="s1">&#39;0px&#39;</span><span class="p">,</span>
      <span class="s1">&#39;margin-top&#39;</span><span class="o">:</span> <span class="s1">&#39;0px&#39;</span><span class="p">,</span>
      <span class="s1">&#39;z-index&#39;</span><span class="o">:</span> <span class="s1">&#39;9999&#39;</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">tooltipSlide</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipTop&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;topRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipInner&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>

    <span class="s1">&#39;&lt;div id=&quot;tooltipBottom&quot;&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomLeft&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;div id=&quot;bottomRight&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">);</span>

    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">tooltipSlide</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">wrapInner</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;tooltipWrapper&quot; style=&quot;width:&#39;</span> <span class="o">+</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$jpWalkthrough</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">draggable</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;drag-area&quot; class=&quot;draggable-area&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tooltipWrapper&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">textRotation</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">content</span><span class="p">).</span><span class="nx">clone</span><span class="p">().</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;#tooltipInner&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;span class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&amp;nbsp;&lt;/span&gt;&#39;</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">case</span> <span class="s1">&#39;top&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">wrapperTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">)</span> <span class="o">-</span> <span class="mi">86</span><span class="p">;</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">wrapperLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">wrapperWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">wrapperTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">);</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="nx">wrapperLeft</span> <span class="o">+</span> <span class="nx">wrapperWidth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">)</span> <span class="o">+</span> <span class="mi">105</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;bottom&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">wrapperTop</span> <span class="o">+</span> <span class="nx">wrapperHeight</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">)</span> <span class="o">+</span> <span class="mi">86</span><span class="p">;</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">wrapperLeft</span> <span class="o">+</span> <span class="p">(</span><span class="nx">wrapperWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">);</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span>
        <span class="nx">top</span> <span class="o">=</span> <span class="nx">wrapperTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetVertical</span><span class="p">);</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="nx">wrapperLeft</span> <span class="o">-</span> <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">arrow</span><span class="p">)</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">offsetHorizontal</span><span class="p">)</span> <span class="o">-</span> <span class="mi">105</span><span class="p">;</span>
        <span class="nx">arrowTop</span> <span class="o">=</span> <span class="nx">arrow</span><span class="p">;</span>
        <span class="nx">arrowLeft</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#jpwTooltip span.&#39;</span> <span class="o">+</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">arrowLeft</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
      <span class="s1">&#39;top&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">top</span><span class="p">),</span>
      <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">left</span><span class="p">)</span>
    <span class="p">});</span>
    <span class="nx">$jpWalkthrough</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>


  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>SCROLL TO TARGET</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">scrollToTarget</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">autoScroll</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">autoScroll</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">popup</span><span class="p">.</span><span class="nx">position</span> <span class="o">!=</span> <span class="s1">&#39;modal&#39;</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">windowHeight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">innerHeight</span><span class="p">(),</span>
          <span class="nx">targetOffsetTop</span> <span class="o">=</span> <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span><span class="p">,</span>
          <span class="nx">targetHeight</span> <span class="o">=</span> <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">||</span> <span class="nx">$jpwTooltip</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">(),</span>
          <span class="nx">overlayTop</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#overlayTop&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">();</span>

        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;html,body&#39;</span><span class="p">).</span><span class="nx">animate</span><span class="p">({</span>
          <span class="nx">scrollTop</span><span class="o">:</span> <span class="p">(</span><span class="nx">targetOffsetTop</span> <span class="o">+</span> <span class="p">(</span><span class="nx">targetHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">windowHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="p">},</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">scrollSpeed</span><span class="p">);</span>

      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;html,body&#39;</span><span class="p">).</span><span class="nx">animate</span><span class="p">({</span>
          <span class="nx">scrollTop</span><span class="o">:</span> <span class="mi">0</span>
        <span class="p">},</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">scrollSpeed</span><span class="p">);</span>
      <span class="p">}</span>

    <span class="p">}</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Render a control button outside the #tooltipInner element.</p>

<p>Parameters:</p>

<ul>
<li><p><strong>id must be a String.</strong><br/>(The button identifier within the options.buttons hash (e.g. 'jpwNext'))</p></li>
<li><p><strong>appendTo can be a jQuery or a String.</strong><br/>((Optional) The element or selector to append the button to. Defaults to #tooltipWrapper)</p></li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">showButton</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">appendTo</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">btn</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">.</span><span class="nx">buttons</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>

    <span class="nx">appendTo</span> <span class="o">=</span> <span class="nx">appendTo</span> <span class="o">||</span> <span class="s1">&#39;#tooltipWrapper&#39;</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check that button is defined</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">btn</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check that button should be shown</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">show</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">btn</span><span class="p">.</span><span class="nx">show</span><span class="p">())</span> <span class="o">||</span> <span class="o">!</span><span class="nx">btn</span><span class="p">.</span><span class="nx">show</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Append button</p></div></div><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">(</span><span class="nx">appendTo</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;a /&gt;&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nx">id</span><span class="p">,</span>
      <span class="nx">html</span><span class="o">:</span> <span class="nx">btn</span><span class="p">.</span><span class="nx">i18n</span>
    <span class="p">}));</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>/* CALLBACK
  /</p></div></div><div class="code"><div class="wrapper">  <span class="c1">//callback for onLoadHidden cookie</span>

  <span class="kd">function</span> <span class="nx">onCookieLoad</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">_elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">options</span><span class="p">[</span><span class="nx">_elements</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">onCookieLoad</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">options</span><span class="p">[</span><span class="nx">_elements</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">onCookieLoad</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">onLeave</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">onLeave</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">onLeave</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">_index</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>

  <span class="p">}</span>

  <span class="c1">//callback for onEnter step</span>

  <span class="kd">function</span> <span class="nx">onEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">onEnter</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">_index</span><span class="p">].</span><span class="nx">onEnter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">_index</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//callback for onClose help</span>

  <span class="kd">function</span> <span class="nx">onClose</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">onClose</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">onClose</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">//set help mode to false</span>
    <span class="c1">//_isWalkthroughActive = false;</span>
    <span class="nx">methods</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//callback for onRestart help</span>

  <span class="kd">function</span> <span class="nx">onRestart</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>
    <span class="c1">//set help mode to true</span>
    <span class="nx">_isWalkthroughActive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">methods</span><span class="p">.</span><span class="nx">restart</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>

    <span class="c1">//auto scroll to target</span>
    <span class="nx">scrollToTarget</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">onRestart</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">onRestart</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//callback for before all first walkthrough element loaded</span>

  <span class="kd">function</span> <span class="nx">onBeforeShow</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span> <span class="o">||</span> <span class="p">{};</span>
    <span class="nx">_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">onBeforeShow</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">onBeforeShow</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//callback for after all first walkthrough element loaded</span>

  <span class="kd">function</span> <span class="nx">onAfterShow</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_activeWalkthrough</span><span class="p">;</span>
    <span class="nx">_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">onAfterShow</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">onAfterShow</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>HELPERS</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">windowWidth</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">innerWidth</span><span class="p">()</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">width</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">debug</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">console</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">clearRotation</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">rotationStyle</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;-webkit-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="c1">//safari</span>
      <span class="s1">&#39;-moz-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="c1">//firefox</span>
      <span class="s1">&#39;-ms-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="c1">//IE9+</span>
      <span class="s1">&#39;-o-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="c1">//opera</span>
      <span class="s1">&#39;filter&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="c1">//IE7</span>
      <span class="s1">&#39;-ms-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span> <span class="c1">//IE8</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">rotationStyle</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">setRotation</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">//for IE7 &amp; IE8</span>
    <span class="kd">var</span> <span class="nx">M11</span><span class="p">,</span> <span class="nx">M12</span><span class="p">,</span> <span class="nx">M21</span><span class="p">,</span> <span class="nx">M22</span><span class="p">,</span> <span class="nx">deg2rad</span><span class="p">,</span> <span class="nx">rad</span><span class="p">;</span>

    <span class="c1">//degree to radian</span>
    <span class="nx">deg2rad</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">360</span><span class="p">;</span>
    <span class="nx">rad</span> <span class="o">=</span> <span class="nx">angle</span> <span class="o">*</span> <span class="nx">deg2rad</span><span class="p">;</span>

    <span class="nx">M11</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">rad</span><span class="p">);</span>
    <span class="nx">M12</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">rad</span><span class="p">);</span>
    <span class="nx">M21</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">rad</span><span class="p">);</span>
    <span class="nx">M22</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">rad</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">rotationStyle</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;-webkit-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;rotate(&#39;</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;deg)&#39;</span><span class="p">,</span> <span class="c1">//safari</span>
      <span class="s1">&#39;-moz-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;rotate(&#39;</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;deg)&#39;</span><span class="p">,</span> <span class="c1">//firefox</span>
      <span class="s1">&#39;-ms-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;rotate(&#39;</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;deg)&#39;</span><span class="p">,</span> <span class="c1">//IE9+</span>
      <span class="s1">&#39;-o-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;rotate(&#39;</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;deg)&#39;</span><span class="p">,</span> <span class="c1">//opera</span>
      <span class="s1">&#39;filter&#39;</span><span class="o">:</span> <span class="s1">&#39;progid:DXImageTransform.Microsoft.Matrix(M11 = &#39;</span> <span class="o">+</span> <span class="nx">M11</span> <span class="o">+</span> <span class="s1">&#39;,M12 = -&#39;</span> <span class="o">+</span> <span class="nx">M12</span> <span class="o">+</span> <span class="s1">&#39;,M21 = &#39;</span> <span class="o">+</span> <span class="nx">M21</span> <span class="o">+</span> <span class="s1">&#39;,M22 = &#39;</span> <span class="o">+</span> <span class="nx">M22</span> <span class="o">+</span> <span class="s1">&#39;,sizingMethod = &quot;auto expand&quot;);&#39;</span><span class="p">,</span> <span class="c1">//IE7</span>
      <span class="s1">&#39;-ms-transform&#39;</span><span class="o">:</span> <span class="s1">&#39;progid:DXImageTransform.Microsoft.Matrix(M11 = &#39;</span> <span class="o">+</span> <span class="nx">M11</span> <span class="o">+</span> <span class="s1">&#39;,M12 = -&#39;</span> <span class="o">+</span> <span class="nx">M12</span> <span class="o">+</span> <span class="s1">&#39;,M21 = &#39;</span> <span class="o">+</span> <span class="nx">M21</span> <span class="o">+</span> <span class="s1">&#39;,M22 = &#39;</span> <span class="o">+</span> <span class="nx">M22</span> <span class="o">+</span> <span class="s1">&#39;,SizingMethod = &quot;auto expand&quot;);&#39;</span> <span class="c1">//IE8</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">rotationStyle</span><span class="p">;</span>

  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">cleanValue</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;px&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">cleanSyntax</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;px&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">cssSyntax</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">val</span><span class="p">)</span> <span class="nx">val</span> <span class="o">=</span> <span class="s1">&#39;0px&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">val</span><span class="p">,</span>
      <span class="nx">arrVal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span>
      <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">top</span><span class="p">,</span> <span class="nx">right</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">returnVal</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arrVal</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//check if syntax is clean with value and &#39;px&#39;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">cleanSyntax</span><span class="p">(</span><span class="nx">arrVal</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nx">counter</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">//all syntax are clean</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">counter</span> <span class="o">==</span> <span class="nx">arrVal</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arrVal</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">switch</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
            <span class="nx">top</span> <span class="o">=</span> <span class="nx">arrVal</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="nx">right</span> <span class="o">=</span> <span class="nx">arrVal</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="nx">bottom</span> <span class="o">=</span> <span class="nx">arrVal</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
            <span class="nx">left</span> <span class="o">=</span> <span class="nx">arrVal</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

      <span class="p">}</span>

      <span class="k">switch</span> <span class="p">(</span><span class="nx">arrVal</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
          <span class="nx">right</span> <span class="o">=</span> <span class="nx">bottom</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">top</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
          <span class="nx">bottom</span> <span class="o">=</span> <span class="nx">top</span><span class="p">;</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
          <span class="nx">left</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">position</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="nx">position</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="o">||</span> <span class="nx">position</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Please define margin position (top, right, bottom, left)&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="k">switch</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s1">&#39;top&#39;</span><span class="o">:</span>
            <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">top</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span>
            <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;bottom&#39;</span><span class="o">:</span>
            <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">bottom</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span>
            <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">left</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">returnVal</span><span class="p">;</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Please check your margin syntax..&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">setCookie</span><span class="p">(</span><span class="nx">c_name</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">exdays</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">exdate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
    <span class="nx">exdate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">exdate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="nx">exdays</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">c_value</span> <span class="o">=</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="nx">exdays</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot;; expires=&quot;</span> <span class="o">+</span> <span class="nx">exdate</span><span class="p">.</span><span class="nx">toUTCString</span><span class="p">());</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="nx">c_name</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nx">c_value</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">getCookie</span><span class="p">(</span><span class="nx">c_name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">ARRcookies</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ARRcookies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span> <span class="o">=</span> <span class="nx">ARRcookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ARRcookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">));</span>
      <span class="nx">y</span> <span class="o">=</span> <span class="nx">ARRcookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">substr</span><span class="p">(</span><span class="nx">ARRcookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
      <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+|\s+$/g</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">==</span> <span class="nx">c_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">unescape</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Returns true if the current step is the last step in the walkthrough.</p>

<p><strong>Returns a Boolean</strong><br/>(true if user is currently viewing last step; false otherwise)</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">isLastStep</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_index</span> <span class="o">==</span> <span class="p">(</span><span class="nx">_activeWalkthrough</span><span class="p">.</span><span class="nx">steps</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Returns true if the current step is the first step in the walkthrough.</p>

<p><strong>Returns a Boolean</strong><br/>(true if user is currently viewing first step; false otherwise)</p></div></div><div class="code"><div class="wrapper">  <span class="kd">function</span> <span class="nx">isFirstStep</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">_index</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>BUTTON CLOSE CLICK</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Close and finish tour buttons clicks </p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;#jpwClose, #jpwFinish&#39;</span><span class="p">,</span> <span class="nx">onClose</span><span class="p">);</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Next button clicks</p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;#jpwNext&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">pagewalkthrough</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">);</span>
  <span class="p">});</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Previous button clicks</p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;#jpwPrevious&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">pagewalkthrough</span><span class="p">(</span><span class="s1">&#39;prev&#39;</span><span class="p">);</span>
  <span class="p">});</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>DRAG &amp; DROP</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Patching for jquery 1.7+</p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mousedown&#39;</span><span class="p">,</span> <span class="s1">&#39;#jpwTooltip #drag-area&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;draggable-area&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;draggable&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;draggable&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;cursor&#39;</span><span class="p">,</span> <span class="s1">&#39;move&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">z_idx</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;z-index&#39;</span><span class="p">),</span>
      <span class="nx">drg_h</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">(),</span>
      <span class="nx">drg_w</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(),</span>
      <span class="nx">pos_y</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">+</span> <span class="p">(</span><span class="nx">drg_h</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">e</span><span class="p">.</span><span class="nx">pageY</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nx">pos_x</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">drg_w</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="nx">drg_w</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span><span class="p">;</span>

    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.draggable&#39;</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">offset</span><span class="p">({</span>
        <span class="nx">top</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">pageY</span> <span class="o">+</span> <span class="nx">pos_y</span> <span class="o">-</span> <span class="nx">drg_h</span><span class="p">,</span>
        <span class="nx">left</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">+</span> <span class="nx">pos_x</span> <span class="o">-</span> <span class="nx">drg_w</span>
      <span class="p">}).</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;mouseup&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s1">&#39;#tooltipWrapper&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;draggable&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
          <span class="s1">&#39;z-index&#39;</span><span class="o">:</span> <span class="nx">z_idx</span><span class="p">,</span>
          <span class="s1">&#39;cursor&#39;</span><span class="o">:</span> <span class="s1">&#39;default&#39;</span>
        <span class="p">});</span>
      <span class="p">});</span>
    <span class="p">});</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">//disable selection</span>
  <span class="p">});</span>

  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseup&#39;</span><span class="p">,</span> <span class="s1">&#39;#jpwTooltip #drag-area&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;draggable&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;cursor&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">);</span>
  <span class="p">});</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>MAIN PLUGIN</p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">.</span><span class="nx">pagewalkthrough</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">pagewalkthrough</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">methods</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span> <span class="p">{</span>

      <span class="k">return</span> <span class="nx">methods</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">methods</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>render the overlay on it has a default walkthrough set to show onload</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="p">(</span><span class="nx">_hasDefault</span> <span class="o">&amp;&amp;</span> <span class="nx">_counter</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">methods</span><span class="p">.</span><span class="nx">renderOverlay</span><span class="p">();</span>
        <span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
      <span class="p">}</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

      <span class="nx">$</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Method &#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39; does not exist on jQuery.pagewalkthrough&#39;</span><span class="p">);</span>

    <span class="p">}</span>

  <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="anamedefaultoptionsoptionsa"><a name="default-options">Options</a></h4>

<p>Default options for each walkthrough.
User options extend these defaults.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">pagewalkthrough</span><span class="p">.</span><span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Array of steps to show</p></div></div><div class="code"><div class="wrapper">    <span class="nx">steps</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>jQuery selector for the element to highlight for this step</p></div></div><div class="code"><div class="wrapper">        <span class="nx">wrapper</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Margin for highlighted element (use CSS syntax)</p></div></div><div class="code"><div class="wrapper">        <span class="nx">margin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="anamepopupoptionspopupoptionsa"><a name="popup-options">Popup options</a></h5></div></div><div class="code"><div class="wrapper">        <span class="nx">popup</span><span class="o">:</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Selector for the element which contains the content, or the literal
content</p></div></div><div class="code"><div class="wrapper">          <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Popup type - either modal, tooltip or nohighlight.  See <a href="/pages/popup-types.html">Popup Types</a></p></div></div><div class="code"><div class="wrapper">          <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;modal&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Position for tooltip and nohighlight style popups - either top, left, right or bottom</p></div></div><div class="code"><div class="wrapper">          <span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Horizontal offset for the walkthrough</p></div></div><div class="code"><div class="wrapper">          <span class="nx">offsetHorizontal</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Vertical offset for the walkthrough</p></div></div><div class="code"><div class="wrapper">          <span class="nx">offsetVertical</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Default width for each popup</p></div></div><div class="code"><div class="wrapper">          <span class="nx">width</span><span class="o">:</span> <span class="s1">&#39;320&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If true, user can drag tooltip and no highlight style popups around</p></div></div><div class="code"><div class="wrapper">          <span class="nx">draggable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Amount in degrees to rotate the content by</p></div></div><div class="code"><div class="wrapper">          <span class="nx">contentRotation</span><span class="o">:</span> <span class="mi">0</span>
        <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Whether the overlay should be shown or not</p></div></div><div class="code"><div class="wrapper">        <span class="nx">overlay</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Allow user interaction with highlighted content - e.g. allow typing in inputs</p></div></div><div class="code"><div class="wrapper">        <span class="nx">accessible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Automatically scroll to the content for the step</p></div></div><div class="code"><div class="wrapper">        <span class="nx">autoScroll</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Speed to use when scrolling to elements</p></div></div><div class="code"><div class="wrapper">        <span class="nx">scrollSpeed</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Prevent the user from scrolling away from the content</p></div></div><div class="code"><div class="wrapper">        <span class="nx">lockScrolling</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback when entering the step</p></div></div><div class="code"><div class="wrapper">        <span class="nx">onEnter</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback when leaving the step</p></div></div><div class="code"><div class="wrapper">        <span class="nx">onLeave</span><span class="o">:</span> <span class="kc">null</span>
      <span class="p">}</span>
    <span class="p">],</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>(Required)</strong> Walkthrough name.  Should be a unique name to identify the walkthrough, as it will
be used in the cookie name</p></div></div><div class="code"><div class="wrapper">    <span class="nx">name</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Automatically show the walkthrough when the page is loaded.  If multiple walkthroughs set this to
true, only the first walkthrough is shown automatically</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onLoad</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback to be executed before the walkthrough is shown</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onBeforeShow</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback executed after the walkthrough is shown</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onAfterShow</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback executed in the event that 'restart' is triggered</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onRestart</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback executed when the walkthrough is closed.  The walkthrough can be closed by the user
clicking the close button in the top right, or clicking the finish button on the last step</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onClose</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Callback executed when cookie has been set after a walkthrough has been closed</p></div></div><div class="code"><div class="wrapper">    <span class="nx">onCookieLoad</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="anamecontrolsoptionswalkthroughcontrolsa"><a name="controls-options">Walkthrough controls</a></h5>

<p>Hash of buttons to show.  Object keys are used as the button element's ID.</p></div></div><div class="code"><div class="wrapper">    <span class="nx">buttons</span><span class="o">:</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>ID of the button</p></div></div><div class="code"><div class="wrapper">      <span class="nx">jpwClose</span><span class="o">:</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Translation string for the button</p></div></div><div class="code"><div class="wrapper">        <span class="nx">i18n</span><span class="o">:</span> <span class="s1">&#39;Click here to close&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Whether or not to show the button.  Can be a boolean value, or a function which returns
a boolean value</p></div></div><div class="code"><div class="wrapper">        <span class="nx">show</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">},</span>
      <span class="nx">jpwNext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">i18n</span><span class="o">:</span> <span class="s1">&#39;Next &amp;rarr;&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Function which resolves to a boolean</p></div></div><div class="code"><div class="wrapper">        <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="o">!</span><span class="nx">isLastStep</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">jpwPrevious</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">i18n</span><span class="o">:</span> <span class="s1">&#39;&amp;larr; Previous&#39;</span><span class="p">,</span>
        <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="o">!</span><span class="nx">isFirstStep</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">jpwFinish</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">i18n</span><span class="o">:</span> <span class="s1">&#39;Finish &amp;#10004;&#39;</span><span class="p">,</span>
        <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">isLastStep</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">));</span></div></div></div></div></body></html>